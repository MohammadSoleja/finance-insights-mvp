{% extends "base.html" %}
{% block title %}Transactions — Finance Insights{% endblock %}

{% block content %}
  <h1>Transactions</h1>

  <div class="card">
    <form method="get" class="toolbar" style="align-items:center; display:flex; gap: .5rem; flex-wrap:wrap;">
      <input class="form-input" type="text" name="q" placeholder="Search description or category" value="{{ q }}" style="flex:1; min-width:180px; max-width:420px;" />

      <label class="form-label" style="margin:0; margin-left:.25rem;">Direction</label>
      <select name="direction" class="form-select" style="width:160px; margin-left:.25rem;">
        <option value="" {% if not direction %}selected{% endif %}>All</option>
        <option value="inflow" {% if direction == 'inflow' %}selected{% endif %}>Inflow</option>
        <option value="outflow" {% if direction == 'outflow' %}selected{% endif %}>Outflow</option>
      </select>

      <label class="form-label" style="margin:0; margin-left:.5rem;">Sort</label>
      <select name="sort" class="form-select" style="width:180px; margin-left:.25rem;">
        <option value="" {% if not sort %}selected{% endif %}>Date (default)</option>
        <option value="date" {% if sort == 'date' %}selected{% endif %}>Date ↑</option>
        <option value="-date" {% if sort == '-date' %}selected{% endif %}>Date ↓</option>
        <option value="amount" {% if sort == 'amount' %}selected{% endif %}>Amount ↑</option>
        <option value="-amount" {% if sort == '-amount' %}selected{% endif %}>Amount ↓</option>
      </select>

      <div style="margin-left:auto;">
        <button class="btn" type="submit">Apply</button>
      </div>
    </form>

    <div class="tablewrap mt-1">
      <table class="preview-table">
        <thead>
          <tr>
            <th>Date</th>
            <th>Description</th>
            <th>Category</th>
            <th style="text-align:right">Amount</th>
            <th>Direction</th>
          </tr>
        </thead>
        <tbody>
          {% for t in page.object_list %}
            <tr>
              <td>{{ t.date }}</td>
              <td>{{ t.description }}</td>
              <td>{{ t.category }}</td>
              <td style="text-align:right">{{ t.amount }}</td>
              <td>{{ t.direction }}</td>
            </tr>
          {% empty %}
            <tr><td colspan="5">No transactions found.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div style="margin-top:1rem; display:flex; justify-content:space-between; align-items:center;">
      <div>
        Page {{ page.number }} of {{ page.paginator.num_pages }} — {{ page.paginator.count }} total
      </div>
      <div>
        {% if page.has_previous %}
          <a class="btn" href="?page=1&{{ params }}">First</a>
          <a class="btn" href="?page={{ page.previous_page_number }}&{{ params }}">Previous</a>
        {% endif %}
        {% if page.has_next %}
          <a class="btn" href="?page={{ page.next_page_number }}&{{ params }}">Next</a>
          <a class="btn" href="?page={{ page.paginator.num_pages }}&{{ params }}">Last</a>
        {% endif %}
      </div>
    </div>

  </div>
{% endblock %}
